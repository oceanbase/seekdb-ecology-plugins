---
slug: /hybrid-search-of-seekdb-js
---

# hybridSearch - Hybrid search

`hybridSearch()` combines full-text search and vector similarity search with ranking.

:::info

This API can only be used when connected with `SeekdbClient`. For more information about `SeekdbClient`, see [SeekdbClient](../50.seekdbclient-of-seekdb-js.md).

:::

## Prerequisites

* You have installed seekdb-js. For more information, see [Quick start](../../10.seekdb-js-get-started.md).

* You have installed the server mode of seekdb. For more information, see [Deploy seekdb by using yum install](../../../../../400.guides/400.deploy/700.server-mode/100.deploy-by-systemd.md).
* You are connected to the database. For more information, see [SeekdbClient](../50.seekdbclient-of-seekdb-js.md).

* You have created a collection and inserted corresponding data. For more information, see [createCollection](../200.collection-of-seekdb-js/100.create-collection-of-seekdb-js.md) and [add](../300.dml-of-seekdb-js/200.add-data-of-seekdb-js.md).

## Request parameters

```js
hybrid_search(
    query={
        "whereDocument": ,
        "where": ,
        "nResults": 
    },
    knn={
        queryEmbeddings
        "queryTexts": 
        "where":
        "nResults": 
    },
    rank=,  
    nResults=,
    include=
)
```

* query: The full-text search configuration, which contains the following parameters:

    |Parameter|Type|Required|Description|Example value|
    |---|---|---|---|---|
    |`where`|Where |No|The metadata filter condition. |`{"category": {"$eq": "AI"}}`|
    |`whereDocument`|WhereDocument|No|The document content filter condition (full-text search). |`{"$contains": "machine"}`|
    |`nResults`|number|No|The number of results returned by full-text search. ||

* knn: The vector search configuration, which contains the following parameters:

    |Parameter|Type|Required|Description|Example value|
    |---|---|---|---|---|
    |`queryEmbeddings`|number\[\] \| number\[\]\[\] |No|The single vector or vector list for batch queries. If provided, it will be used directly (ignoring embeddingFunction). If not provided, `query_text` must be provided, and `collection` must have `embeddingFunction`|[1.0, 2.0, 3.0]|
    |`queryTexts`|string \| string\[\]|No|The single vector0 or vector list. If provided, it will be used directly (ignoring `embeddingFunction`). If not provided, `documents` must be provided, and `collection` must have `embeddingFunction`.|["my query text"]|
    |`where`|Where |No|The metadata filter condition. |`{"category": {"$eq": "AI"}}`|
    |`nResults`|number|No|The number of results returned by vector search. ||

* Other parameters are as follows:

    |Parameter|Type|Required|Description|Example value|
    |`rank`|HybridSearchRank |No|The ranking configuration. For example: `{"rrf": {"rank_window_size": 60, "rank_constant": 60}}`|`{"category": {"$eq": "AI"}}`|
    |`nResults`|number|Yes|The number of similar results to return. Default value: 10|3|
    |`include`|readonly ("documents" \| "metadatas" \| "embeddings" \| "distances")\[\]|No|The list of fields to include: `["documents", "metadatas", "embeddings"]`.|["documents", "metadatas", "embeddings"]|

:::info

* The `embeddingFunction` used is associated with the collection (set during `createCollection()` or `getCollection()`). You cannot override it for each operation.
* At least one of query or knn must be provided.
* knn:
  * If `queryEmbeddings` is provided, the dimensions will be validated against `collection.dimension`.
  * `queryTexts`: string or string[]; the `embeddingFunction` of the collection is used to automatically embed (if the function is missing, a ValueError is returned).
* If `knn.queryTexts` is provided, `embeddingFunction` must be configured.

:::

## Request example

```js
import { SeekdbClient } from "seekdb";

const client = new SeekdbClient({
  host: "127.0.0.1",
  port: 2881,
  user: "root",
  password: "",
  database: "test",
});

const collection = await client.getCollection({name: 'my_collection'});

const results = await  collection.hybridSearch({
    query: {
        whereDocument: {$contains: "machine learning"},
        nResults: 10
    },
        knn: {
        queryTexts: 'documents',
        nResults: 10
    },
    rank: {rrf: {}},
    nResults: 10
});

```

## Response parameters

The search result dictionary, which contains the ID, distances, metadatas, document, and embeddings.

## Related operations

* [Vector query](200.query-interfaces-of-seekdb-js.md)
* [Retrieval](300.get-interfaces-of-seekdb-js.md)
* [Operators](500.filter-operators-of-seekdb-js.md)